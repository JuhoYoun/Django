로그인, 회원 가입, 게시글 작성 이 세 화면들의 공통점은?
바로 웹 서비스에서 정보를 입력하고 서버와 통신한다는것이다 이렇게 웹 서비스에서 사용자로부터 입력을 받은 데이터를 서버로 전송하기 위한 방식을 form 이라고 한다
이번 챕터에서는 폼의 개념에 대해 알아보고 장고에서 폼 처리하는 법을 배워보자 폼을 다룰 수 있게되면 포스트 작성 수정 삭제 기능을 모두 구현할 수 있다
지금까지 같이 구현헤본 read 조회 기능은 데이터베이스에서 데이터를 가져와 템플릿으로 전송한 뒤 렌더해서 사용자에게 보여주면 되었다 Create은 그 반대로
웹에서 사용자의 입력을 받아서 서버로 전송해주어야한다 이때 사용하는것이 바로 폼이다 먼저 폼이 어떻게 생겼나 보자 이 폼 코드들을 지금 다 이해할 필요는 없다
장고를 이용하면 이러한 폼의 대부분의 요소가 자동으로 만들어지기 때문이다

<form action="next/" method="post">
  <label for ="name">이름</label>
  <input type="text" id="name" name="name"/>
  <label for="email">이메일</label>
  <input type="email" id="email" name="email"/>
  <label for="birth">생일</label>
  <input type="date" id="birth" name="birth"/>
  <input type="submit" value="전송">
</form>

이 코드르 렌더하면

이름
[                   ]
이메일
[                   ]
생일
[연도. 월. 일.    달력]
[전송버튼]

이런식으로 우리에게 익숙한 모습이 된다

HTML 폼은 이렇게 폼 태그 안에 여러 컴포넌트들로 구성되어있다
보면 label과 input이 짝 지어져있는데
  <label for ="name">이름</label>
  <input type="text" id="name" name="name"/>
이 label 부분은 앞에 어떤것을 입력해야되는지 나타내고 input 부분은 실재로 입력하는 곳이 된다

이름   (label)
[                   ]   (input)

그리고 우리가 입력을 하려고 하다 보면 전송하려는 데이터에 따라서 생일처럼 달력 형식으로 입력을 받기도 하고 이름처럼 한줄로 입력을 받기도 한다
이렇게 데이터에 따라 다라지는 입력 형식을 위젯(widget)이라고 한다 그리고 이런 위젝은 input 태그 안의 type에서 결정된다 예를 들어 text라고 하면 한줄로 입력받는 형태가 되고
date 이라고 쓰면 달력 형식으로 나오게된다 이 밖에도 우리가 자주 보았던 체크박스, 라디오버튼 등 기본으로 제공하는 타입이 있고 각각의 위젯을 커스텀해서 JavaScript나 CSS를 함께 사용하기도 한다
다시 폼으로 돌아와서 마지막으로 데이터를 입력했으면 서버로 전송할 수 있는 버튼이 있어야한다 폼에서 전송을 위한 타입이 submit이라고 한다 마찬가지로 Input을 써러 만들어주면 된다
버튼 위에 적은 글씨는 vlaue 속성으로 표현할 수 있다
------------------------------------------------------------------------------------------------------------------------------------------------
폼 처리

form이 처리되는 과정
폼 처리 과정을 이해하려면 일단 GET과 POST 요청에 대해 알아야한다 
클라이언트는 서버에게 요청을 하고 서버는 요청을 받아 처리한 후 응답으로 클라이언트에게 돌려준다 이 때 클라이언트가 보내는 모든 리퀘스트는 서버에게 요청하는 종류에 따라 몇가지 방식으로
나뉘는데 가장 많이 쓰이는 것이 GET과 POST이다

GET은 서버로부터 데이터를 조회할 때 사용한다 GET 방식으로 요청을 보낼 때 요청에 포함하고 싶은 데이터가 있을 수 있는데 GET 방식으로 요청을 보낼 때는 필요한 데이터를 URL에 담아서 보낸다
ex> "지웅"의 프로필 화면을 보여줘 -> 데이터를 url에 담아서 보냄 -> http://example.com/user/profile?name=지웅&email=chojw@codeit.kr&birth=1122

example에 보면 ?가 나오고 여러가지 데이터가 함께 나와있다 이렇게 url 뒤에 붙는 데이터 문자열을 쿼리 스트링이라고 하는데 데이터를 전달하는 가장 단순한 방법이다

query string : 서버에 요청할 때 원하는 것을 상세하게 표현할 때 사용

보면 물음표를 사용해서 url의 끝을 알려주고 그 다음부터는 사전형처럼 키와 밸류의 쌍으로 데이터를 표시하고 각각의 데이터는 &로 구분해준다 
GET 방식으로 요청할 때는 쿼리 스트링을 이용해 클라이언트의 데이터가 서버에 전송된다 자 지금처럼 이름과 이메일 생일 뿐만 아니라 비밀번호나 카드번호 같이 민감한 데이터를 서버에 보내야
할 때도 있는데 이럴 때 url에 데이터를 담아서 전송하는 방식을 적합하지 않다 그래서 데이터를 전송할 때는 POST 방식을 가장 많이 사용한다

Post 
Post는 게시하다는 의미처럼 클라이언트가 서버에 데이터를 변경하는 요청을 할 때 사용한다 그리고 POST 방식의 요청은 쿼리 스트링을 이용하지 않고 클라이언트와 서버가 통신하는 메시지의 안쪽에
데이터를 담기 때문에 url에 노출되지 않는다

CRUD로 생각하면 데이터를 생성하는 것은 서버에게 데이터를 추가 즉 변경하도록 요청하는 것이므로 POST 방식을 사용하고 조회는 서버의 데이터를 변경하는 것이 아니므로 GET 방식을 사용한다
수정과 삭제는 역시 데이터를 변경하는 것이니 POST 방식을 사용한다

우리가 직접 사용하는 예로는 구글에서 검색을 하거나 유투브의 동영상을 볼 때는 모두 GET 방식을 사용한다 서버의 데이터를 변경하는 것이 아니라 서버로부터 데이터를가져오는 것이기 때문
반면에 회원가입 블로그 글쓰기 유투브 동영상 올리기 트위터에 글 수정 삭제하기 등은 서버의 데이터를 변경하는 것이므로 모두 POST 방식을 사용한다 

자 이 차이점을 알았다면 아까 전의 코드를 다시 한번 보자

<form action="next/" method="post">
  <label for ="name">이름</label>
  <input type="text" id="name" name="name"/>
  <label for="email">이메일</label>
  <input type="email" id="email" name="email"/>
  <label for="birth">생일</label>
  <input type="date" id="birth" name="birth"/>
  <input type="submit" value="전송">
</form>

여기 보면 form 태그의 속성으로 action과 method 가 있다 이 부분은 지금 폼에 입력된 데이터를 method 방식 즉 POST 요청을 통해서 action에 해당하는 URL 보내겠다는 뜻이다
그러니까 전송 버튼을 누르면 폼의 데이터를 이 url로 post 요청으로 보낸다는 의미이다 아직 이해가 잘 되지 않을 수 있으니 폼이 처리되는 전체 과정을 한번 보자

첫째 맨 먼저 사용자가 폼을 작성하기 위해 서버에 폼 양식을 요청한다 (회원 가입 페이지 같은거) 그런데 처음 요청할 때는 서버로부터 폼 양식을 조회하는 것이므로 GET 방식을 사용한다
이 부분을 이해하는 것이 중요하다 다시 설명하자면 폼이 있는 페이지를 처음 요청할 때는 서버로부터 해당 페이지를 단순히 조회하는 것이므로 GET 방식을 사용한다 그리고 이렇게 처음 서버가 제공하는
폼을 언 바운드 폼이라고 한다 (unbound form) Bound는 결합된 묶여진 이런 뜻인데 아직 데이터가 묶여있지 안기 때문에 이 상태를 언바운드 폼이라고 한다 

자 두번째로 사용자가 데이터를 입력하고 서버로 전송한다 (회원가입할 때 정보 입력하고 회원가입 버튼을 누른다) 이 때 폼의 method에 명시되어있는 Post 방식으로 action에 해당하는 url로 데이터를 전달한다
데이터를 전달한다는 표현은 다시 말하면 폼의 데이터와 함께 post 방식으로 서버에 요청하는 것이다

세번째, 서버에서 입력된 데이터와 폼을 합쳐서 하나의 형태로 만든다 (데이터 + 폼) 이 과정을 바인딩이라고 한다 이렇게 데이터와 합쳐진 폼을 bound form 이라고 한다

네번째, 만약 바운드 폼에서 가져온 데이터 즉 입력된 데이터가 올바르지 않다면 유효하지 않은 잘못된 데이터이므로 사용자에게 다시 폼을 입력하도록 한다

예를 들어 이름을 입력하는 곳에 숫자를 입력했다면 다시 입력하도록 하는것이다 폼 데이터가 유효할 떄 까지 두번째에게 네번째 단계가 반복된다

다섯번째, 입력된 데이터가 유효하다면 다음으로 서버에 지정한 로직을 수행한다 입력된 데이터를 가지고 가공하거나 수정하거나 뭐 저장하거나 등의 작업을 한다

여섯번째, 작업이 모두 끝났다면 새로운 페이지를 안내한다 다시 말하면 새로운 페이지를 사용자에게 응답으로 돌려준다
-----------------------------------------------------------------------------------------------------------------------------------------------

form이 처리되는 과정 중 맨마지막에 바인딩을 한 후 올바른 값을 입력했을 경우 새로운 페이지를 안내한다고 설명하셨는데,

최근에는 데이터를 입력하고나서 새로운 페이지 안내 없이

 작성데이터가 그 자리에서 업데이트 되는 사이트가 많은 것으로 알고있습니다. 

혹시 이러한 기술은 어떤 원리나 어떤 방법을 사용하여 구현하는 것인가요?? 

제가 이해한 질문이 맞다면 서버단에서 이루어지던 일들이 클라이언트 단에서도 이루어지면서 변화된 내용으로 생각합니다. 

  
Ajax 와 같은 서버와 비동기로 주고받을 수 있는게 등장하면서 기존에는 서버에서 다시 모든 데이터를 가져와서 화면에 렌더링 하는 방식으로 구현하였다면,

Ajax 는 필요한 데이터만 가져올 수 있기 때문에 화면 전환없이 필요한 부분만 클라이언트 단에서 처리를 할 수 있게 된거죵.
--------------------------------------------------------------------------------------------------------------------------

HTML Form

폼은 웹 페이지에서 사용자의 데이터를 입력받을 수 있는 입력 양식을 말합니다.  아래에서 배우는 여러 Form 요소들은 Django에서 제공하는 폼을 사용하면 저절로 생성되지만 기본적인 HTML 폼을 알고 있으면 Django의 폼을 이해하는데 많은 도움이 됩니다.
label과 input

폼은 form태그 안에 사용자의 입력을 받는 input태그와 설명을 위한 label태그의 쌍으로 구성됩니다.

<form>
    <lable>이름</lable>
    <input type="text">
</form>

https://bakey-api.codeit.kr/api/files/resource?root=static&seqId=4134&directory=Untitled.png&name=Untitled.png
for & id

각각의 input태그와 label태그를 묶어주기 위해서 label태그에는 for 속성, input태그에는 id가 사용됩니다.

<form>
    <label for="title">제목</label>
    <input type="text" id="title">
</form>

만약 여기에서 for와 id 속성을 적어주고 싶지 않다면 label 태그로 input태그를 감싼 형태를 사용하면 됩니다.

<form>
    <label>제목
        <input type="text">
    </label>
</form>

name

name은 입력된 데이터를 서버로 전송할 때, 서버에서 각각의 데이터를 구분하기 위한 속성으로 name 속성이 있는 양식 요소만 값이 서버로 전달됩니다.

<form>
    <label for="title">제목</label>
    <input type="text" id="title" name="title">
</form>

type

type은 입력할 값에 따른 유형을 나타내는 속성입니다. 이 type에 따라 사용자가 브라우저에서 값을 입력하는 형식인 위젯(widget)이 달라집니다. 자주 사용되는 type은 아래와 같습니다.

    email

<label for="email">이메일</label>
<input type="email" id="email" name="email">

https://bakey-api.codeit.kr/api/files/resource?root=static&seqId=4134&directory=Untitled%201.png&name=Untitled+1.png

    password

<label for="pwd">비밀번호</label>
<input type="password" id="pwd" name="pwd">

https://bakey-api.codeit.kr/api/files/resource?root=static&seqId=4134&directory=Untitled%202.png&name=Untitled+2.png

    button

<input type="button" value="버튼입니다">

https://bakey-api.codeit.kr/api/files/resource?root=static&seqId=4134&directory=Untitled%203.png&name=Untitled+3.png

    radio

<input type="radio" id="male" name="gender" value="male">
<label for="male">남자</label><br>
<input type="radio" id="female" name="gender" value="female">
<label for="female">여자</label><br>
<input type="radio" id="other" name="gender" value="other">
<label for="other">기타</label>

https://bakey-api.codeit.kr/api/files/resource?root=static&seqId=4134&directory=Untitled%204.png&name=Untitled+4.png

    checkbox

<input type="checkbox" id="lang1" name="lang1" value="Python">
<label for="lang1">파이썬(Python)</label><br>
<input type="checkbox" id="lang2" name="lang2" value="JAVA">
<label for="lang2">자바(JAVA)</label><br>
<input type="checkbox" id="lang3" name="lang3" value="Go">
<label for="lang3">고(Go)</label><br>

https://bakey-api.codeit.kr/api/files/resource?root=static&seqId=4134&directory=Untitled%205.png&name=Untitled+5.png

    date

<label for="birthday">생년월일</label>
<input type="date" id="birthday" name="birthday">

https://bakey-api.codeit.kr/api/files/resource?root=static&seqId=4134&directory=Untitled%206.png&name=Untitled+6.png

    file

<label for="userfiles">파일선택</label>
<input type="file" id="userfiles" name="userfiles" multiple>

https://bakey-api.codeit.kr/api/files/resource?root=static&seqId=4134&directory=Untitled%207.png&name=Untitled+7.png

    submit

<input type="submit" value="전송하기"> 

https://bakey-api.codeit.kr/api/files/resource?root=static&seqId=4134&directory=Untitled%208.png&name=Untitled+8.png
form 속성

form에는 입력된 데이터를 전송할 서버의 URL을 지정하는 action과 http 전달 방식을 지정해 주는 method 속성이 있습니다.

<form action="register" method="post">
    <label for="name">이름</label>
    <input type="text" id="name" name="name">
    <input type="submit" value="제출하기">
</form>

GET과 POST

GET 방식으로 지정하면 유저가 데이터를 입력하고 전송했을 때 URL 뒤에 쿼리 스트링(Query String) 형태로 데이터가 전달됩니다.

<form action="/register" method="get">
    <label for="name">이름</label>
    <input type="text" id="name" name="name">
    <label for="email">이메일</label>
    <input type="email" id="email" name="email">
    <input type="submit" value="제출하기">
</form>

http://www.codeit-django.com/register?name=우재&email=woojae@codeit.kr

POST 방식은 전송되는 URL에는 표시되지 않고 서버로 전송하는 메세지 안쪽에 데이터를 넣어서 전달합니다. 이 부분에 대해서는 조금 더 나중에 자세하게 다루겠습니다.

<form action="/register" method="post">
    <label for="name">이름</label>
    <input type="text" id="name" name="name">
    <label for="email">이메일</label>
    <input type="email" id="email" name="email">
    <input type="submit" value="제출하기">
</form>

http://www.codeit-django.com/register

그러면 언제 GET을 사용하고 언제 POST를 사용해야 할까요? 그것을 결정하는 것은 이 요청이 무엇을 하는지에 달려 있습니다. GET은 가져오다는 의미처럼 서버에서 데이터를 가져오는 요청을 보낼 때 사용하고 그 외에 서버의 데이터를 변경하거나 다른 로직을 수행할 때는 POST를 사용합니다. 간단히 정리하면 form을 사용할 때는 사용자로부터 데이터를 입력받아서 저장, 수정 등의 데이터베이스와 관련된 로직을 많이 수행하죠? 그렇기 때문에 form에서는 대부분의 경우 POST를 사용한다고 생각하면 됩니다.

----------------------------------------------------------------------------------------------------------------------------------------

CRUD 중 Create 에 해당하는 블로그 글 쓰기 페이지의 폼을 만들어보자 사용자로부터 입력을 받을 수 있는 형태가 되겠죠? 관리자 페이지의 포스트 작성 페이지를 보자
그런식으로 문자열 형식의 제목과 내용을 입력하는 곳이 있고 SAVE 즉 작성한 데이터를 서버로 전송하는 버튼도 있다 이렇게 세가지 기능을 폼으로 구현해보자

먼저 posts 디렉토리 안에 new file 을 해서 forms.py를 만든다 이곳에서 우리가 사용할 폼을 구현하고 템플릿과 뷰에서는 이 폼을 가져다가 사용만 하면 된다
장고 폼은 Form 클래스는 작성하는것 부터 시작한다 하나의 Form 클래스가 하나의 폼이 되는거다 그대로 따라 적어봐라
->
from django import forms 

class PostForm(forms.Form):

자 모든 Form 클래스는 이런식으로 django forms의 Form 클래스를 상속해서 구현한다 자 그 다음에 이제 클래스 안의 input 항목들을 하나씩 만들어주면 된다
작성하는 방식이 모델을 작성할 때와 매우 비슷하다
->
class PostForm(forms.Form):
    title = forms.CharField(max_length=50, label='제목')
    content = forms.CharField(label='내용', widget=forms.Textarea)

먼저 제목은 title로 그리고 forms 안에 있는 CharField를 이용해서 작성한다 최대길이와 레이블 해준다
그리고 내용은 content라는 변수에 역시 forms의 CharField를 이용해서 작성한다 레이블 해주고 widget 설정도 해준다
자 앞서 보았던 HTML 폼을 떠올려보면 우리가 input 태그를 적을 때 타입 속성에 따라 위젝이 구분된다고 했었다 기본적으로 모든 폼 필드는 해당 필드에 맞는 디폴트 위젝 즉 
기본 위젝을 가지고 있다 날짜를 입력하는 DateField라면 달력모양으로 입력을 받는 위젯 CharField라면 한 줄 입력을 위한 위젝이 기본적으로 설정되어있다
그리고 필요하다면 폼 필드를 정의할 때 위젯을 따로 명시할 수 있다 이 CharField는 기본적으로 TextInput 위젯 즉 한 줄 입력을 위한 위젯을 가지고 있는데
여기 내용의 경우 문자열이긴 하지만 여러 줄 입력을 해야한다 여러줄 입력을 위한 위젯은 Textarea가 있다 그래서 이런식으로 위젯을 설정한다
자 폼에 대한 정의는 이것으로 끝인데 우리가 모델을 정의할 때와 굉장희 비슷하다


